//
// Engine Ignitor upgrades patch

//
// Toolbox
@PARTUPGRADE[Toolbox]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @techRequired = advLogistics
}

//
// Ignition system upgrades moved around for ETT
// Based on original EI configs made by forum user @mrZonke
@PARTUPGRADE[ignitionUpgrade_1]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @techRequired = fuelSystems
    @entryCost = 15000
}
@PARTUPGRADE[ignitionUpgrade_2]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @techRequired = advancedRocketry125
    @entryCost = 26000
}
@PARTUPGRADE[ignitionUpgrade_3]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @techRequired = heavyRCS
    @entryCost = 32000
}
@PARTUPGRADE[ignitionUpgrade_4]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
	@techRequired = MultiFunctionLFO
	@entryCost = 48000
}
@PARTUPGRADE[ignitionUpgrade_8]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @techRequired = experimentalElectricalSystems
    @entryCost = 58000
}

//
// Engines Ignition Upgrades
// Ignitor upgrade 1
@PART[liquidEngine]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_1]]
            {
                @techRequired__ = fuelSystems
                @IgnitorType = Internal
				@UseUllageSimulation = true
				@ChanceWhenUnstable = 0.2  //0-1
                @IgnitionsAvailable = 4
            }
        }
    }
}
@PART[liquidEngine2]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_1]]
            {
                @techRequired__ = fuelSystems
                @IgnitionsAvailable = 8
            }
        }
    }
}
@PART[liquidEngine3]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_1]]
            {
                @techRequired__ = fuelSystems
                @IgnitionsAvailable = 16
            }
        }
    }
}

// Ignitor upgrade 2
@PART[radialLiquidEngine1-2]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_2]]
            {
                @techRequired__ = advancedRocketry125
                @IgnitionsAvailable = 28
            }
        }
    }
}
@PART[liquidEngine3]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_2]]
            {
                @techRequired__ = advancedRocketry125
                @IgnitionsAvailable = 20
            }
        }
    }
}
@PART[microEngine]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_2]]
            {
                @techRequired__ = advancedRocketry125
                @IgnitionsAvailable = 26
            }
        }
    }
}
@PART[liquidEngineMini]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_2]]
            {
                @techRequired__ = advancedRocketry125
                @IgnitionsAvailable = 24
            }
        }
    }
}

// Ignitor upgrade 3
@PART[liquidEngine2-2]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_3]]
            {
                @techRequired__ = heavyRCS
                @IgnitionsAvailable = 30
            }
        }
    }
}
@PART[microEngine]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_3]]
            {
                @techRequired__ = heavyRCS
                @IgnitionsAvailable = 30
            }
        }
    }
}
@PART[smallRadialEngine]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_3]]
            {
                @techRequired__ = heavyRCS
                @IgnitionsAvailable = 36
            }
        }
    }
}

// Ignitor upgrade 4
@PART[microEngine]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_4]]
            {
                @techRequired__ = MultiFunctionLFO
                @IgnitionsAvailable = 36
            }
        }
    }
}
@PART[radialEngineMini]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_4]]
            {
                @techRequired__ = MultiFunctionLFO
                @IgnitionsAvailable = 36
            }
        }
    }
}
@PART[liquidEngineMini]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_4]]
            {
                @techRequired__ = MultiFunctionLFO
                @IgnitionsAvailable = 32
            }
        }
    }
}
@PART[smallRadialEngine]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_4]]
            {
                @techRequired__ = MultiFunctionLFO
                @IgnitionsAvailable = 24
            }
        }
    }
}

// Ignitor upgrade 8
@PART[SSME]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE[ignitionUpgrade_8]
            {
                @techRequired__ = experimentalElectricalSystems
                @IgnitionsAvailable = 4
                @IgnitorType = Internal
                @UseUllageSimulation = true
                @ChanceWhenUnstable = 0.2
                @ECforIgnition = 40
            }
        }
    }
}
@PART[nuclearEngine]:NEEDS[EngineIgnitor]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE[ignitionUpgrade_8]
            {
                @techRequired__ = experimentalElectricalSystems
                @IgnitionsAvailable = 45
            }
        }
    }
}

//
// Part Overhauls
@PART[liquidEngineT30|liquidEngineT30_Boattail]:NEEDS[EngineIgnitor,PartOverhauls]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_4]]
            {
                @techRequired__ = MultiFunctionLFO
				@IgnitorType = Internal
				@UseUllageSimulation = true
				@ChanceWhenUnstable = 0.2
                @IgnitionsAvailable = 4
            }
        }
    }
}
@PART[liquidEngineT45|liquidEngineT45_Boat]:NEEDS[EngineIgnitor,PartOverhauls]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE:HAS[name__[ignitionUpgrade_4]]
            {
                @techRequired__ = MultiFunctionLFO
                @IgnitionsAvailable = 8
            }
        }
    }
}

@PART[liquidEngine909|liquidEngine909_Boattail]:NEEDS[EngineIgnitor,PartOverhauls]:LAST[zzzETT]
{
    @MODULE[ModuleEngineIgnitor]
    {
        @UPGRADES
        {
            @UPGRADE[heavyRCS]
            {
                @techRequired__ = heavyRCS
                @IgnitionsAvailable = 20
            }
        }
    }
}
